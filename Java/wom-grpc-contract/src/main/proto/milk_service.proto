syntax = "proto3";

option java_package = "sep3.wayofmilk.grpc";
option java_multiple_files = true;
option csharp_namespace = "Sep3.WayOfMilk.Grpc";

import "repeatingMessageTypes.proto";

enum MilkTestResultEnum {
  MILK_TEST_UNKNOWN = 0;
  MILK_TEST_PASS = 1;
  MILK_TEST_FAIL = 2;
}

message MilkMessage {
  int64 id = 1;
  int64 cowId = 2;
  int64 containerId = 3;
  int64 registeredByUserId = 4;
  string date = 5;
  double volumeL = 6;
  MilkTestResultEnum testResult = 7;
  bool approvedForStorage = 8;   // NEW
}

message CreateMilkRequest {
  int64 cowId = 1;
  int64 containerId = 2;
  int64 registeredByUserId = 3;
  string date = 4;
  double volumeL = 5;
  MilkTestResultEnum testResult = 6;
}

message UpdateMilkRequest {
  int64 id = 1;
  int64 containerId = 2;
  string date = 3;
  double volumeL = 4;
  MilkTestResultEnum testResult = 5;
}

message MilkByContainerQuery {
  int64 containerId = 1;
}

message ApproveMilkStorageRequest {
  int64 milkId = 1;
  int64 approvedByUserId = 2;
  bool approvedForStorage = 3; // true to approve
}

message MilkListReply {
  repeated MilkMessage milk = 1;
}

service MilkService {
  rpc CreateMilk (CreateMilkRequest) returns (MilkMessage);
  rpc UpdateMilk (UpdateMilkRequest) returns (MilkMessage);
  rpc DeleteMilk (SentId) returns (Empty);
  rpc GetMilk (SentId) returns (MilkMessage);
  rpc GetAllMilk (Empty) returns (MilkListReply);
  rpc GetMilkByContainer (MilkByContainerQuery) returns (MilkListReply);

  // NEW
  rpc ApproveMilkStorage (ApproveMilkStorageRequest) returns (MilkMessage);
}
